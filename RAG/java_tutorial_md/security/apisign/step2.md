[Download
the JDK](http://java.sun.com/javase/6/download.jsp)
  
[Search the
Tutorials](../../search.html)
  
[Hide the TOC](javascript:toggleLeft())

**Trail:** Security Features in Java SE
  
**Lesson:** Generating and Verifying Signatures
  
**Section:** Generating a Digital Signature

[Generating and Verifying Signatures](index.html)

[Generating a Digital Signature](gensig.html)

[Prepare Initial Program Structure](step1.html)

Generate Public and Private Keys

[Sign the Data](step3.html)

[Save the Signature and the Public Key in Files](step4.html)

[Compile and Run the Program](step5.html)

[Verifying a Digital Signature](versig.html)

[Prepare Initial Program Structure](vstep1.html)

[Input and Convert the Encoded Public Key Bytes](vstep2.html)

[Input the Signature Bytes](vstep3.html)

[Verify the Signature](vstep4.html)

[Compile and Run the Program](vstep5.html)

[Weaknesses and Alternatives](enhancements.html)

[Home Page](../../index.html)
>
[Security Features in Java SE](../index.html)
>
[Generating and Verifying Signatures](index.html)

[« Previous](step1.html) • [Trail](../TOC.html) • [Next »](step3.html)

# Generate Public and Private Keys

In order to be able to create a digital signature, you need a private
key. (Its corresponding public key will be needed in order to verify
the authenticity of the signature.)

In some cases the *key pair* (private
key and corresponding public key) are already available
in files. In that case the program can import and use the private key
for signing, as shown in
[Weaknesses and Alternatives](enhancements.html).

In other cases the program needs to generate the key pair.
A key pair is generated by using the `KeyPairGenerator` class.

In this example you will generate a public/private key pair for the
Digital Signature Algorithm (DSA). You will generate keys
with a 1024-bit length.

Generating a key pair requires several steps:

**Create a Key Pair Generator**
> The first step is to get a key-pair generator object for generating
> keys for the DSA signature algorithm.
>
> As with all engine classes, the way to get a
> `KeyPairGenerator` object for a particular type of algorithm
> is to call the `getInstance` static factory method on the
> `KeyPairGenerator` class. This method has two forms,
> both of which hava a `String algorithm` first argument;
> one form also has a `String provider` second argument.
>
> A caller may thus optionally specify the name of a provider,
> which will guarantee that the implementation of the algorithm
> requested is from the named provider.
> The sample code of this lesson always specifies the
> default SUN provider built into the JDK.
>
> Put the following statement after the
>
> ```
>
> else try {
>
> ```
>
> line in the file created in the previous step, [Prepare Initial Program Structure](step1.html):
>
> ```
>
> KeyPairGenerator keyGen =
>     KeyPairGenerator.getInstance("DSA", "SUN");
>
> ```

**Initialize the Key-Pair Generator**
> The next step is to initialize the key-pair generator.
> All key-pair generators share the concepts of a keysize and a
> source of randomness. The `KeyPairGenerator` class has an
> `initialize` method that takes these two types of arguments.
>
> The keysize for a DSA key generator is the key length (in bits), which
> you will set to 1024.
>
> The source of randomness must be an instance of the `SecureRandom`
> class. This example requests one that uses the SHA1PRNG
> pseudo-random-number generation algorithm, as provided by
> the built-in SUN provider. The example then passes this `SecureRandom`
> instance to the key-pair generator initialization method.
>
> ```
>
> SecureRandom random =
>     SecureRandom.getInstance("SHA1PRNG", "SUN");
> keyGen.initialize(1024, random);
>
> ```
>
> Note: The `SecureRandom` implementation attempts to completely randomize
> the internal state of the generator itself unless the caller follows the call to the
> `getInstance` method with a call to the `setSeed`
> method. So if you had a specific seed value that you wanted used, you would
> call the following prior to the `initialize` call:
>
> ```
>
> random.setSeed(seed);
>
> ```

**Generate the Pair of Keys**
> The final step is to generate the key pair and to store the
> keys in `PrivateKey` and `PublicKey` objects.
>
> ```
>
> KeyPair pair = keyGen.generateKeyPair();
> PrivateKey priv = pair.getPrivate();
> PublicKey pub = pair.getPublic();
>
> ```

[« Previous](step1.html)
•
[Trail](../TOC.html)
•
[Next »](step3.html)

---

Problems with the examples? Try [Compiling and Running
the Examples: FAQs](../../information/run-examples.html).
  
Complaints? Compliments? Suggestions? [Give
us your feedback](http://download.oracle.com/javase/feedback.html).

Your use of this page and all the material on pages under "The Java Tutorials" banner,
and all the material on pages under "The Java Tutorials" banner is subject to the [Java SE Tutorial Copyright
and License](../../information/license.html).
Additionally, any example code contained in any of these Java
Tutorials pages is licensed under the
[Code
Sample License](http://developers.sun.com/license/berkeley_license.html).

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
| |  |  | | --- | --- | | duke image | Oracle logo | | [About Oracle](http://www.oracle.com/us/corporate/index.html) | [Oracle Technology Network](http://www.oracle.com/technology/index.html) | [Terms of Service](https://www.samplecode.oracle.com/servlets/CompulsoryClickThrough?type=TermsOfService) | Copyright © 1995, 2011 Oracle and/or its affiliates. All rights reserved. |

**Previous page:** Prepare Initial Program Structure
  
**Next page:** Sign the Data




A browser with JavaScript enabled is required for this page to operate properly.